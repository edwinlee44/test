SELECT 
DATA_DT,
ACTUAL_DATE,
ENTITY,
BOOK_ID,
TRN_PRODUCT,
COMPONENT_TYPOLOGY,
TYPOLOGY,
STRATEGY,
PACKAGE_NO,
ORIGINAL_CONTRACT_NO,
CONTRACT_NO,
TRN_NB,
CREATOR,
STATUS,
STP_STATUS,
PORTFOLIO_CODE,
TRADE_DATE,
EXPIRE_DATE,
OSWP_MAT_DATE,
COUNTERPARTY_CODE,
COUNTERPARTY_NAME,
CP_INDUSTRY,
BANK,
LOCALE,
COUNTRY,
HOME_COUNTRY,
B_S,
STRIKE_PRICE,
CUR,
NOMINAL_AMT,
PRE_CUR,
PREMIUM_AMOUNT,
M_TP_ACCSCT,
PAY_CUR,
PAY_AMOUNT,
REC_CUR,
REC_AMOUNT,
FRA_CONTRACT_RATE,
FRA_FIXING_DATE,
FRA_INT_START,
FRA_INT_END,
FRA_INDEX,
FUT_SECCNT,
FUT_M_TP_SECMKT,
FUT_M_INSTRUMENT,
FUT_M_TP_DTELBL,
FUT_STRIKE_PRICE,
FUT_M_TP_IQTY,
FUT_BROKER_FEE_CUR,
FUT_BROKER_FEE,
FUT_C_P,
IRS_MAIN_TRADE,
IRS_M_NOM_MUL,
BACKDATE_FLAG,
M_CNTLEVTL2,
RPT_TRADE_D_FLAG,
RPT_TRADE_M_FLAG
  FROM    V_AC_IR_TRADE_REP TP
where DATA_DT @I_DT:D
and SUBSTR(ENTITY,1,7) @I_ENTITY:C
and DECODE(@I_FREQUENCY:C,'DAILY',RPT_TRADE_D_FLAG,'MONTHLY',RPT_TRADE_M_FLAG) = 'Y'
   and (( @I_FREQUENCY:C like '%DAILY%')
      or ( @I_FREQUENCY:C like '%MONTHLY%'    ))