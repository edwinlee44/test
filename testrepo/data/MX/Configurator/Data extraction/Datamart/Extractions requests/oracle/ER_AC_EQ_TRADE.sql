SELECT 
DATA_DT,
ACTUAL_DATE,
TRADENUMBER,
INSTRUMENT,
PORTFOLIO,
BUYSELL,
TRADE_DATE,
ISINTERNAL,
CURRENCY,
SB_QUANTITY,
S_B_PRICE,
S_B_CUMAMT_DEAL,
FMLY,
M_TRN_GRP,
TRADE_CATEGORY,
M_CNT_USG,
STRATEGY,
M_TP_ACCSCT,
ENTITY,
PAYMENT_DATE,
UDF_PURPOS,
ORG_TRADENUMBER,
SECURITY_NM,
COUNTERPARTY,
CLEARING,
INTEREST_COMP,
RPT_TRADE_D_FLAG,
RPT_TRADE_M_FLAG,
BROKER_TAX,
BROKER_FEE,
ROOT_CONTRACT,
M_CNT_EVTL
  FROM    V_AC_EQ_TRADE_REP TP
where ENTITY @I_ENTITY:C
   and DATA_DT @I_DT:D 
   and DECODE(@I_FREQUENCY:C,'DAILY',RPT_TRADE_D_FLAG,'MONTHLY',RPT_TRADE_M_FLAG) = 'Y'
   and (( @I_FREQUENCY:C like '%DAILY%')
      or ( @I_FREQUENCY:C like '%MONTHLY%'    ))   