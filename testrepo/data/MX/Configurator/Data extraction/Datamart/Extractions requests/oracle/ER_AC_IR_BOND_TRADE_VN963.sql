SELECT 
DATA_DT,
ACTUAL_DATE,
ENTITY,
BOOK_ID,
TRN_PRODUCT,
M_CMP_TYPO,
TYPOLOGY,
STRATEGY,
M_PACKAGE,
M_CNT_ORG,
M_CONTRACT,
TRN_NB,
CREATOR,
STATUS,
STP_STATUS,
PORTFOLIO_CODE,
START_DATE,
TRADE_DATE,
EXPIRE_DATE,
COUNTERPARTY_CODE,
COUNTERPARTY_NAME,
CP_INDUSTRY,
BANK,
LOCALE,
COUNTRY,
HOME_COUNTRY,
B_S,
CUR,
NOMINAL_AMT,
M_TP_ACCSCT,
BOND_COUPON_RATE,
REPO_RATE,
BACKDATE_FLAG,
M_CNTLEVTL2,
RPT_TRADE_D_FLAG,
RPT_TRADE_M_FLAG,
BOND_ISIN_CD
  FROM    V_AC_IR_BOND_REPO_TRADE_REP TP
where DATA_DT @I_DT:D
and SUBSTR(ENTITY,1,7) @I_ENTITY:C
and DECODE(@I_FREQUENCY:C,'DAILY',RPT_TRADE_D_FLAG,'MONTHLY',RPT_TRADE_M_FLAG) = 'Y'
   and (( @I_FREQUENCY:C like '%DAILY%')
      or ( @I_FREQUENCY:C like '%MONTHLY%'    ))