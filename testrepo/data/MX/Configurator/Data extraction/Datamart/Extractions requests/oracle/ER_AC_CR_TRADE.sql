 SELECT 
   DATA_DT,
   TRN_NB,
   PORTFOLIO_CODE,
   ENTITY,
   CREATOR,
   ORIGINAL_CONTRACT_NO,
   CONTRACT_NO,
   TRADE_DATE,
   LINK_NO,
   PACKAGE_NO,
   BOOK_ID,
   TRN_PRODUCT,
   COMPONENT_TYPOLOGY,
   TYPOLOGY,
   STRATEGY,
   SECTION,
   STATUS,
   STP_STATUS,
   ISSUER,
   ISSER_DESC,
   ISSUER_CATEGORY,
   DEBT_TYPE,
   EXPIRE_DATE,
   NOMINAL_CUR,
   NOMINAL_AMT,
   PREMIUM_BP,
   COUNTERPARTY_CODE,
   COUNTERPARTY_NAME,
   BANK,
   LOCALE,
   COUNTRY,
   B_S,
   CRED_INDEX,
   SETTLEMENT,
   RPT_TRADE_D_FLAG,
   RPT_TRADE_M_FLAG
  FROM V_AC_CR_TRADE_REP CR
where ENTITY @I_ENTITY:C
   and DATA_DT @I_DT:D 
   and DECODE(@I_FREQUENCY:C,'DAILY',RPT_TRADE_D_FLAG,'MONTHLY',RPT_TRADE_M_FLAG) = 'Y'
   and (( @I_FREQUENCY:C like '%DAILY%')      or ( @I_FREQUENCY:C like '%MONTHLY%'    ))   