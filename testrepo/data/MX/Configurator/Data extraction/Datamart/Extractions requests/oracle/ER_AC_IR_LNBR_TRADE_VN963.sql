SELECT 
DATA_DT,
M_MRPL_DATE,
M_TP_ENTITY,
TRN_BU,
TRN_PRODUCT,
PROD,
M_CMP_TYPO,
M_TP_TYPO,
M_TP_STRTGY,
M_PACKAGE,
M_CNT_ORG,
M_CONTRACT,
M_NB,
TRN_STATUS,
M_STP_STATUS,
M_TP_PFOLIO,
TRN_START_DT,
TRN_TRADE_DT,
M_TP_DTEEXP,
CNTRP_CD,
CNTRP_NM,
CNTRP_INDUS_CD,
CNTRP_BNK_FLAG,
CNTRP_LOCALE,
CNTRP_CNTRY_CD,
CNTRP_HOMECNTRY,
TRN_BS_FLAG,
NOM_AMT_CCY,
NOM_AMT,
M_TP_ACCSCT,
PAY_RATE,
REC_RATE,
UDF,
DERIVE_CUR,
DERIVE_AMT,
DIFF,
BACKDATE_FLAG,
M_CNTLEVTL2,
RPT_TRADE_D_FLAG,
RPT_TRADE_M_FLAG
  FROM    V_AC_IR_LNBR_TRADE_REP TP
where DATA_DT @I_DT:D
and SUBSTR(M_TP_ENTITY,1,7) @I_ENTITY:C
and DECODE(@I_FREQUENCY:C,'DAILY',RPT_TRADE_D_FLAG,'MONTHLY',RPT_TRADE_M_FLAG) = 'Y'
   and (( @I_FREQUENCY:C like '%DAILY%')
      or ( @I_FREQUENCY:C like '%MONTHLY%'    ))